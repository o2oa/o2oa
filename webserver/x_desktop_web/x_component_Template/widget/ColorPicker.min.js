MWF.xApplication.Template=MWF.xApplication.Template||{};MWF.xApplication.Template.widget=MWF.xApplication.Template.widget||{};MWF.xDesktop.requireApp("Template","MTooltips",null,false);MWF.xApplication.Template.widget.ColorPicker=new Class({Implements:[Options,Events],Extends:MTooltips,options:{style:"default",axis:"y",position:{x:"auto",y:"auto"},nodeStyles:{"min-width":"200px"}},initialize:function(e,t,i,s,o,n){if(o){this.setOptions(o)}this.container=e;this.target=t;this.targetCoordinates=n;this.app=i;this.lp=i.lp;this.data=s;this.path="/x_component_Template/widget/$ColorPicker/";this.cssPath="/x_component_Template/widget/$ColorPicker/"+this.options.style+"/css.wcss";this._loadCss();if(this.target){this.setTargetEvents()}},_loadCss:function(e){var i=encodeURIComponent(this.cssPath);if(!e&&MWF.widget.css[i]){this.css=MWF.widget.css[i]}else{this.cssPath=this.cssPath.indexOf("?")!=-1?this.cssPath+"&v="+COMMON.version:this.cssPath+"?v="+COMMON.version;var t=new Request.JSON({url:this.cssPath,secure:false,async:false,method:"get",noCache:false,onSuccess:function(e,t){this.css=e;MWF.widget.css[i]=e}.bind(this),onError:function(e,t){alert(t+e)}});t.send()}},_customNode:function(e){MWF.UD.getDataJson("colorPicker",function(e){this.contentNode=new Element("div").inject(this.node);this.previewArea=new Element("div",{styles:this.css.previewArea}).inject(this.contentNode);this.previewNode=new Element("div",{styles:this.css.previewNode}).inject(this.previewArea);this.previewValueNode=new Element("div",{styles:this.css.previewValueNode}).inject(this.previewArea);if(e){this.laterPickedColor=e.laterPickedColor||[];this.createLaterPickedNode(this.laterPickedColor)}this.themeArea=new Element("div").inject(this.contentNode);new Element("div",{styles:this.css.titleNode,text:"主题颜色"}).inject(this.themeArea);this.themeNode=new Element("div",{styles:this.css.colorContainer}).inject(this.themeArea);var t=["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"];for(var i=0;i<t.length;i++){this.createColorNode(t[i],this.themeNode)}this.theme2Node=new Element("div",{styles:this.css.colorContainer}).inject(this.themeArea);this.theme2Node.setStyle("margin-bootom","5px");var s=["#f2f2f2","#808080","#ddd8c2","#c6d9f1","#dbe5f1","#f2dbdb","#eaf1dd","#e5dfec","#daeef3","#fde9d9","#d9d9d9","#595959","#c4bc96","#8db3e2","#b8cce4","#e5b8b7","#d6e3bc","#ccc0d9","#b6dde8","#fbd4b4","#bfbfbf","#404040","#938953","#548dd4","#95b3d7","#d99594","#c2d69b","#b2a1c7","#92cddc","#fabf8f","#a6a6a6","#262626","#4a442a","#17365d","#365f91","#943634","#76923c","#5f497a","#31849b","#e36c0a","#7f7f7f","#0d0d0d","#1c1a10","#0f243e","#243f60","#622423","#4e6128","#3f3151","#205867","#974706"];for(var i=0;i<s.length;i++){this.createColorNode(s[i],this.theme2Node)}this.standardArea=new Element("div").inject(this.contentNode);new Element("div",{styles:this.css.titleNode,text:"标准颜色"}).inject(this.standardArea);this.standardNode=new Element("div",{styles:this.css.colorContainer}).inject(this.standardArea);var o=["#c00000","#ff0000","#ffc000","#ffff00","#92d050","#00b050","#00b0f0","#0070c0","#002060","#7030a0"];for(var i=0;i<o.length;i++){this.createColorNode(o[i],this.standardNode)}}.bind(this))},createColorNode:function(e,t){var i=this;var s=new Element("div",{styles:{border:"1px solid "+e,"background-color":e},events:{mouseover:function(){i.previewNode.setStyle("background-color",this);i.previewValueNode.set("text",this)}.bind(e),click:function(){i.clickColorNode(this);i._select(this);i.fireEvent("select",[this]);i.hide()}.bind(e)}}).inject(t);s.setStyles(this.css.colorNode)},clickColorNode:function(e){var t=this.laterPickedColor=this.laterPickedColor||[];t.unshift(e);t=this.unique(t);t=t.slice(0,10);MWF.UD.putData("colorPicker",{laterPickedColor:t},null,false);this.createLaterPickedNode(t)},createLaterPickedNode:function(e){if(this.laterPickedArea){this.laterPickedNode.empty()}else{this.laterPickedArea=new Element("div").inject(this.contentNode);new Element("div",{styles:this.css.titleNode,text:"最近使用"}).inject(this.laterPickedArea);this.laterPickedNode=new Element("div",{styles:this.css.colorContainer}).inject(this.laterPickedArea)}for(var t=0;t<e.length;t++){this.createColorNode(e[t],this.laterPickedNode)}},unique:function(e){var t=[];var i={};for(var s=0;s<e.length;s++){if(!i[e[s]]){t.push(e[s]);i[e[s]]=1}}return t},_select:function(e){}});