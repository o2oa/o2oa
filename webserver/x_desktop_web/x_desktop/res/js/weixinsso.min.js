layout=window.layout||{};var locate=window.location;layout.protocol=locate.protocol;var href=locate.href;if(href.indexOf("debugger")!=-1)layout.debugger=true;layout.desktop=layout;layout.session=layout.session||{};COMMON.DOM.addReady(function(){COMMON.AjaxModule.load("/x_desktop/res/framework/mootools/plugin/mBox.Notice.js",null,false);COMMON.AjaxModule.load("/x_desktop/res/framework/mootools/plugin/mBox.Tooltip.js",null,false);COMMON.setContentPath("/x_desktop");COMMON.AjaxModule.load("mwf",function(){MWF.defaultPath="/x_desktop"+MWF.defaultPath;MWF.loadLP("zh-cn");MWF.require("MWF.widget.Mask",null,false);layout.mask=new MWF.widget.Mask({style:"desktop"});layout.mask.load();MWF.require("MWF.xDesktop.Layout",function(){MWF.require("MWF.xDesktop.Authentication",null,false);(function(){layout.load=function(){var o=href.toURI();MWF.require("MWF.xDesktop.Actions.RestActions",function(){var t=new MWF.xDesktop.Actions.RestActions("","x_organization_assemble_authentication","");t.getActions=function(t){this.actions={sso:{uri:"/jaxrs/qyweixin/code/{code}",method:"GET"}};if(t)t()};t.invoke({name:"sso",async:true,parameter:{code:o.getData("code")},success:function(t){"appMobile.html?app=process.TaskCenter".toURI().go()}.bind(this),failure:function(t,o,e){"appMobile.html?app=process.TaskCenter".toURI().go()}.bind(this)})})};layout.isAuthentication=function(){layout.authentication=new MWF.xDesktop.Authentication({onLogin:layout.load.bind(layout)});var t=true;this.authentication.isAuthenticated(function(t){this.user=t.data;layout.session.user=t.data}.bind(this),function(){this.authentication.loadLogin(this.node);t=false}.bind(this));return t};layout.notice=function(t,o,e,n,a){if(!n)n={x:"right",y:"top"};if(!e)e=this.content;if(!o)o="ok";var i=e||$(document.body);var s=a;if(!s){s={x:10,y:n.y.toString().toLowerCase()=="bottom"?10:10}}new mBox.Notice({type:o,position:n,move:false,target:i,delayClose:o=="error"?1e4:5e3,offset:s,content:t})};MWF.getJSON("res/config/config.json",function(t){layout.config=t;MWF.xDesktop.getServiceAddress(layout.config,function(t,o){layout.serviceAddressList=t;layout.centerServer=o;layout.load()}.bind(this))})})()})})});